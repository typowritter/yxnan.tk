<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>运行脚本</title>
  <meta name="description" content="Texts about blog links and games.">
  <style>
    div.body {
        margin-top: 0%;
        margin-bottom: 5%;
        margin-right: 5%;
        margin-left: 5%;
    }
  </style>
</head>
<body>
  <!--<BODY TEXT=#000000 BGCOLOR=#FFFFFF link=#000000 vlink=#888888>-->
  <div align="right">
    <font face="sans"></font>
    <table border="0" width="100%">
      <tr>
        <td width="100%" valign="middle"><b>yxnan</b></td>
        <td nowrap="nowrap" valign="middle">
          <a href="/">主页</a>
        </td>
        <td valign="middle">&nbsp;&nbsp;&nbsp;<font size="+1">|</font>&nbsp;&nbsp;&nbsp;</td>
        <td valign="middle">
          <a href="/en/server-scripts">English</a>
        </td>
        <td valign="middle">&nbsp;&nbsp;&nbsp;<font size="+1">|</font>&nbsp;&nbsp;&nbsp;</td>
        <td nowrap="nowrap" valign="middle">
          <a href="/blog/about">链接</a>
        </td>
        <td valign="middle">&nbsp;&nbsp;&nbsp;<font size="+1">|</font>&nbsp;&nbsp;&nbsp;</td>
        <td nowrap="nowrap" valign="middle">
          <a href="mailto:yxnan@pm.me">联系</a>
        </td>
        <td valign="middle">&nbsp;&nbsp;&nbsp;</td>
      </tr>
    </table>
  </div>
  <hr size="3" color="black">
  <br>
  <br>
  <div class="body">
    <!--============================================================-->
    <font size="+4">自动重启配置</font><br>
    <br>
    <b>服务器系统：Ubuntu 20.04 64-bit</b><br>


    <br><br><br>
    <font size=+2>
    启动命令
    <br><br>
    </font>

    鉴于求生之路是一款有些年头的游戏了，官方也一直没有做64位适配，服务器在64位系统上跑起来总有各种问题，崩溃什么的都是常事。<br>
    加了 <code>-debug</code> 参数想看看 coredump，但是只记录了一堆不明所以的寄存器值，完全没用；<br>
    进一步调试感觉是内存泄漏问题，没办法了，干脆让它打完一场战役自动重启一次。（<i>Unix Haters Book</i> 名场面）<br>
    需配合 Sourcemod 插件 <b>Reset Server When Empty</b> 使用，并配置为 Hard reset.<br>
    <br>
    文件 <code><i>~/server</i></code>

    <br><br>
    <pre><b>
      <span style="color: rgb(153, 153, 153);">#!/bin/bash</span>

      while :
      do
        ~/steam/l4d2/srcds_run -console -game left4dead2 +port 27015 -insecure -nomaster
        echo -e "Hit Ctrl+C in 3 seconds to prevent restart\n"
        <span style="color: rgb(255, 0, 0);">sleep 3</span>
      done
    </b></pre>

    <br>
    设置快速启动别名：<br><br>
    <code>alias svr='screen -dm -S l4d2 ~/server'</code>

  </div>
</body>
</html>
